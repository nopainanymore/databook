# 第八章、堆

## 堆的核心设置

### 概述

![image](https://static.lovedata.net/20-11-16-1654f8c4eff1be5500c9d7aa249de46f.png-wm)

![image](https://static.lovedata.net/20-11-16-654bb588f4dea2209f5ea103ee62efc4.png-wm)



![image](https://static.lovedata.net/20-11-16-e056d91a2c2c556c32ed845de70be61c.png-wm)



![image](https://static.lovedata.net/20-11-16-9b13b0cd602d8380bf825df6a7f3b716.png-wm)



### 堆内存细分

![image](https://static.lovedata.net/20-11-16-25c7ebdfa86889985720c864b4b8f37c.png-wm)



![image](https://static.lovedata.net/20-11-16-a44676d3c38afbe07adcf38facb75810.png-wm)



![image](https://static.lovedata.net/20-11-16-6041afb9014a3767ce2d536627a6c1d2.png-wm)



#### JDK7

![image](https://static.lovedata.net/20-11-16-56a17288c70dd2f09c2e29c4aa77e632.png-wm)

#### JDK8

![image](https://static.lovedata.net/20-11-16-de3229864a47ed4110bc41388a2743bd.png-wm)

## 设置堆内存大小与OOM

![image](https://static.lovedata.net/20-11-17-1aa759b0f706d4c3ef6b18d7729ea514.png-wm)

> 新生代的总内存=Eden区+一个 from 或者 to 区的内存

![image](https://static.lovedata.net/20-11-17-d7c8b9e50ead11ecfc71b6232c6cfa60.png-wm)

![image](https://static.lovedata.net/20-11-17-fc6671dfd8d8a21f97c6df3a158c46eb.png-wm)

![image](https://static.lovedata.net/20-11-17-e45bfe3cdd65587df4af986e8a770455.png-wm)

## 年轻代与年老代

![image](https://static.lovedata.net/20-11-17-fffde89f44bed81da8e6a38f484455a6.png-wm)

![image](https://static.lovedata.net/20-11-17-c5497ddd7a5c4f62f683d4614220f8de.png-wm)



![image](https://static.lovedata.net/20-11-17-e3c02b4ae86a124e630fcdc31a7d7605.png-wm)





## 图解对象分配过程

![image](https://static.lovedata.net/20-11-17-2a2be1d169adb0d5382957a51f612719.png-wm)



![image](https://static.lovedata.net/20-11-17-2512eecbcd534d5b2d0ed84e81715b83.png-wm)

![image](https://static.lovedata.net/20-11-17-a5ecce6b0b93acd45305bb584068be7b.png-wm)

> 每次执行完Monitor GC，谁空，谁就变成to区

![image](https://static.lovedata.net/20-11-17-6e7d4b530f7a58d21aaf83850c7fdf8d.png-wm)

![image](https://static.lovedata.net/20-11-17-98ecbd73429291f8d283311a79f12fe5.png-wm)



### 对象分配特殊情况

![image-20201117091031326](/Users/apple/Library/Application Support/typora-user-images/image-20201117091031326.png)

## Monitor GC、Major GC、Full GC

![image](https://static.lovedata.net/20-11-20-6267034ca0b2e11ab4af89cbc96150b0.png-wm)

![image](https://static.lovedata.net/20-11-20-fc27ac92486fdfae067ecb790ad448b7.png-wm)

![image](https://static.lovedata.net/20-11-20-5b4b2b6553d576a7d8151eec9eb0edb3.png-wm)

![image](https://static.lovedata.net/20-11-20-785b8bbd48c06c0715de6c6b83a4811c.png-wm)

![image](https://static.lovedata.net/20-11-20-cde2c2d83f91f38ed479ea9d1aefbb7e.png-wm)

## 堆空间的分代思想

![image](https://static.lovedata.net/20-11-20-a50889674fdf201d50ef1ed72e641b98.png-wm)

![image](https://static.lovedata.net/20-11-20-b444d227e585e7bc3514925560083080.png-wm)

## 内存的分配策略

## 为对象分配内存：TLAB

## 小结堆空间的参数设置

## 堆是分配的对象的唯一选择